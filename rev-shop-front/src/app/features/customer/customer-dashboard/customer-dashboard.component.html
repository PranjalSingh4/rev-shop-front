<div class="customer-dashboard">
  <div class="dashboard-header">
    <h1>My Dashboard</h1>
    <p>Welcome back! Here's your order history</p>
  </div>

  <div class="summary-card" *ngIf="!isLoading">
    <div class="summary-item">
      <span class="label">Total Orders</span>
      <span class="value">{{ totalOrders }}</span>
    </div>
  </div>

  <div class="orders-section" *ngIf="!isLoading">
    <h2>Your Orders</h2>
    <div class="orders-container">
      <div class="order-card" *ngFor="let order of orders">
        <div class="order-header">
          <div>
            <h3>Order #{{ order.id }}</h3>
            <p class="order-date">{{ getOrderDate(order) }}</p>
          </div>
          <span class="status-badge" [ngClass]="'status-' + (order.status?.toLowerCase() || 'placed')">
            {{ order.status || 'Placed' }}
          </span>
        </div>

        <div class="order-items">
          <h4>Items in this order:</h4>
          <ul>
            <li *ngFor="let item of order.items">
              {{ item?.product?.name || item?.name }} x{{ item?.quantity }} - Rs{{ ((item?.product?.price || item?.price || 0) * (item?.quantity || 1)).toFixed(2) }}
            </li>
          </ul>
        </div>

        <!-- Delivery Address Section -->
        <div class="order-address" *ngIf="order.address">
          <h4>Delivery Address:</h4>
          <div class="address-details">
            <p><strong>{{ order.address.fullName }}</strong></p>
            <p>{{ order.address.streetAddress }}</p>
            <p>{{ order.address.city }}, {{ order.address.state }} {{ order.address.postalCode }}</p>
            <p>{{ order.address.country }}</p>
            <p>ðŸ“± {{ order.address.phoneNumber }}</p>
          </div>
        </div>

        <div class="order-total">
          <strong>Total:</strong> Rs{{ getOrderTotal(order).toFixed(2) }}
        </div>
      </div>

      <div class="no-orders" *ngIf="orders.length === 0">
        <p>You haven't placed any orders yet.</p>
        <a routerLink="/customer/shop" class="btn-start-shopping">Start Buying</a>
      </div>
    </div>
  </div>

  <div class="loading" *ngIf="isLoading">
    <p>Loading your orders...</p>
  </div>
</div>

<app-footer></app-footer>
